# Open Deep Research å®Œæ•´å·¥ä½œæµç¨‹å›¾

## è¯¦ç»†å·¥ä½œæµç¨‹å›¾

```mermaid
graph TB
    %% ç”¨æˆ·äº¤äº’å±‚ - é¡¶éƒ¨
    subgraph "ğŸ‘¤ ç”¨æˆ·äº¤äº’å±‚"
        A[ğŸ“ ç”¨æˆ·è¾“å…¥ç ”ç©¶ä¸»é¢˜]
        B[â“ æ¾„æ¸…é—®é¢˜äº¤äº’]
        C[ğŸ“„ æœ€ç»ˆç ”ç©¶æŠ¥å‘Š]
    end

    %% ä¸»å·¥ä½œæµç¨‹ - ä¸­ä¸Š
    subgraph "ğŸš€ ä¸»å·¥ä½œæµç¨‹"
        D[ğŸ” clarify_with_user<br/>ç”¨æˆ·æ¾„æ¸…é˜¶æ®µ<br/>â€¢ æ£€æŸ¥allow_clarification<br/>â€¢ åˆ†ææ¶ˆæ¯æ¸…æ™°åº¦<br/>â€¢ è¿”å›æ¾„æ¸…é—®é¢˜æˆ–éªŒè¯]
        E[ğŸ“‹ write_research_brief<br/>ç ”ç©¶è®¡åˆ’é˜¶æ®µ<br/>â€¢ ç”Ÿæˆç»“æ„åŒ–ç ”ç©¶ç®€æŠ¥<br/>â€¢ åˆå§‹åŒ–ç›‘ç£è€…ç³»ç»Ÿæç¤º<br/>â€¢ è®¾ç½®ç ”ç©¶ç­–ç•¥]
        F[ğŸ”„ research_supervisor<br/>ç ”ç©¶æ‰§è¡Œé˜¶æ®µ<br/>å¤šè½®ç›‘ç£å¾ªç¯]
        G[ğŸ“„ final_report_generation<br/>æŠ¥å‘Šç”Ÿæˆé˜¶æ®µ<br/>â€¢ æå–æ‰€æœ‰ç ”ç©¶ç¬”è®°<br/>â€¢ ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š<br/>â€¢ å¤„ç†tokené™åˆ¶]
    end

    %% ç›‘ç£è€…å­å›¾ - ä¸­é—´å·¦ä¾§
    subgraph "ğŸ¯ ç›‘ç£è€…å­å›¾ (Supervisor)"
        H[ğŸ§  supervisor<br/>ç­–ç•¥è§„åˆ’<br/>â€¢ åˆ†æç ”ç©¶ç®€æŠ¥<br/>â€¢ åˆ¶å®šç ”ç©¶ç­–ç•¥<br/>â€¢ å§”æ´¾ç ”ç©¶ä»»åŠ¡<br/>â€¢ ç›‘æ§è¿›åº¦]
        I[âš™ï¸ supervisor_tools<br/>å·¥å…·æ‰§è¡Œ<br/>â€¢ æ‰§è¡Œthink_toolåæ€<br/>â€¢ å¹¶è¡Œæ‰§è¡ŒConductResearch<br/>â€¢ å¤„ç†ResearchComplete<br/>â€¢ èšåˆç ”ç©¶ç»“æœ]
        J[ğŸ”€ ç ”ç©¶å§”æ´¾ç®¡ç†<br/>å¹¶å‘æ§åˆ¶<br/>â€¢ é™åˆ¶å¹¶å‘æ•°é‡<br/>â€¢ åˆ†é…å¤šä¸ªç ”ç©¶ä»»åŠ¡<br/>â€¢ ç­‰å¾…ç ”ç©¶å®Œæˆ]

        H --> I
        I -.-> H
    end

    %% ç ”ç©¶äººå‘˜å­å›¾ - ä¸­é—´å³ä¾§
    subgraph "ğŸ”¬ ç ”ç©¶äººå‘˜å­å›¾ (Researcher)"
        L[ğŸ” researcher<br/>å…·ä½“ç ”ç©¶<br/>â€¢ è·å–å¯ç”¨å·¥å…·<br/>â€¢ é…ç½®æœç´¢å·¥å…·<br/>â€¢ ç»‘å®šMCPå·¥å…·<br/>â€¢ ç”Ÿæˆç ”ç©¶å“åº”]
        M[ğŸ› ï¸ researcher_tools<br/>å·¥å…·å¤„ç†<br/>â€¢ å¹¶è¡Œæ‰§è¡Œæœç´¢<br/>â€¢ æ‰§è¡ŒMCPå·¥å…·<br/>â€¢ å¤„ç†think_tool<br/>â€¢ æ£€æŸ¥é€€å‡ºæ¡ä»¶]
        N[ğŸ“Š compress_research<br/>ç»“æœå‹ç¼©<br/>â€¢ å‹ç¼©ç ”ç©¶å†…å®¹<br/>â€¢ æå–åŸå§‹ç¬”è®°<br/>â€¢ å¤„ç†tokené™åˆ¶<br/>â€¢ è¿”å›æ‘˜è¦ç»“æœ]

        L --> M
        M --> N
        M -.-> L
    end

    %% å†³ç­–å·¥å…· - åº•éƒ¨å·¦ä¾§
    subgraph "ğŸ¤” å†³ç­–å·¥å…·"
        P[ğŸ§  think_tool<br/>æˆ˜ç•¥æ€è€ƒ<br/>â€¢ æˆ˜ç•¥è§„åˆ’<br/>â€¢ åæ€æ€»ç»“<br/>â€¢ å†³ç­–åˆ†æ]
        S[âœ… ResearchComplete<br/>å®Œæˆå·¥å…·<br/>â€¢ æ ‡è®°ç ”ç©¶å®Œæˆ<br/>â€¢ è§¦å‘å¾ªç¯ç»“æŸ]
    end

    %% æ‰§è¡Œå·¥å…· - åº•éƒ¨å³ä¾§
    subgraph "âš¡ æ‰§è¡Œå·¥å…·"
        O[ğŸ” æœç´¢APIå·¥å…·<br/>â€¢ Tavilyæœç´¢<br/>â€¢ OpenAIæœç´¢<br/>â€¢ Anthropicæœç´¢<br/>â€¢ DuckDuckGo<br/>â€¢ Exaæœç´¢]
        Q[ğŸ”Œ MCPå¤–éƒ¨å·¥å…·<br/>â€¢ PDFå¤„ç†<br/>â€¢ æ•°æ®åˆ†æ<br/>â€¢ APIè°ƒç”¨]
        R[ğŸ“¤ ConductResearch<br/>å§”æ´¾å·¥å…·<br/>â€¢ å§”æ´¾ç ”ç©¶ä»»åŠ¡<br/>â€¢ è°ƒç”¨researcherå­å›¾]
    end

    %% ä¸»æµç¨‹è¿æ¥
    A --> D
    D --> E
    E --> F
    F --> G
    G --> C

    %% æ¾„æ¸…å¾ªç¯
    B -.->|æ¾„æ¸…å›å¤| D

    %% å·¥å…·è¿æ¥
    I --> P
    I --> S
    I --> R

    M --> O
    M --> P
    M --> Q
    M --> S

    %% å§”æ´¾æµç¨‹
    R --> J
    J -.-> L

    %% ç ”ç©¶å®Œæˆè¿”å›
    N --> J
    J --> I

    %% å¢å¼ºçš„æ ·å¼å®šä¹‰
    classDef userLayer fill:#e3f2fd,stroke:#1976d2,stroke-width:3px,color:#000
    classDef mainLayer fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px,color:#000
    classDef supervisorLayer fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,color:#000
    classDef researcherLayer fill:#fff8e1,stroke:#f57c00,stroke-width:2px,color:#000
    classDef decisionTool fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
    classDef execTool fill:#e0f2f1,stroke:#00796b,stroke-width:2px,color:#000

    class A,B,C userLayer
    class D,E,F,G mainLayer
    class H,I,J supervisorLayer
    class L,M,N researcherLayer
    class P,S decisionTool
    class O,Q,R execTool

```

## å…³é”®å·¥ä½œæµç¨‹è¯´æ˜

### ğŸ” æ¾„æ¸…é˜¶æ®µ (clarify_with_user)

- **è¾“å…¥**: ç”¨æˆ·åŸå§‹ç ”ç©¶ä¸»é¢˜
- **å¤„ç†**: æ£€æŸ¥é…ç½®ã€è°ƒç”¨AIåˆ†ææ¶ˆæ¯æ¸…æ™°åº¦
- **è¾“å‡º**: æ¾„æ¸…é—®é¢˜æˆ–éªŒè¯æ¶ˆæ¯ï¼Œè¿›å…¥ç ”ç©¶è®¡åˆ’é˜¶æ®µ

### ğŸ“‹ ç ”ç©¶è®¡åˆ’é˜¶æ®µ (write_research_brief)

- **è¾“å…¥**: æ¾„æ¸…åçš„ç”¨æˆ·æ¶ˆæ¯
- **å¤„ç†**: ç”Ÿæˆç»“æ„åŒ–ç ”ç©¶ç®€æŠ¥ã€åˆå§‹åŒ–ç›‘ç£è€…
- **è¾“å‡º**: ç ”ç©¶ç®€æŠ¥ã€supervisor_messagesï¼Œè¿›å…¥ç›‘ç£è€…é˜¶æ®µ

### ğŸ”„ ç›‘ç£è€…å¾ªç¯ (Supervisor Loop)

1. **supervisor**: åˆ†æä¸Šä¸‹æ–‡ã€ç”Ÿæˆå·¥å…·è°ƒç”¨
2. **supervisor_tools**: æ‰§è¡Œå·¥å…·è°ƒç”¨ã€æ£€æŸ¥é€€å‡ºæ¡ä»¶
3. **å¾ªç¯ç»§ç»­**: ç›´åˆ°æ»¡è¶³ç»“æŸæ¡ä»¶æˆ–å§”æ´¾ç ”ç©¶ä»»åŠ¡

### ğŸ”¬ ç ”ç©¶äººå‘˜å¾ªç¯ (Researcher Loop)

1. **researcher**: é…ç½®å·¥å…·ã€ç”Ÿæˆç ”ç©¶å“åº”
2. **researcher_tools**: æ‰§è¡Œæœç´¢å’Œå¤„ç†ã€æ£€æŸ¥é€€å‡ºæ¡ä»¶
3. **compress_research**: å‹ç¼©ç»“æœã€è¿”å›ç›‘ç£è€…

### ğŸ“„ æŠ¥å‘Šç”Ÿæˆé˜¶æ®µ (final_report_generation)

- **è¾“å…¥**: æ‰€æœ‰ç ”ç©¶ç¬”è®°å’Œå‘ç°
- **å¤„ç†**: é…ç½®æŠ¥å‘Šæ¨¡å‹ã€ç”Ÿæˆç»¼åˆæŠ¥å‘Š
- **è¾“å‡º**: æœ€ç»ˆç ”ç©¶æŠ¥å‘Š

## æ ¸å¿ƒæœºåˆ¶è¯¦è§£

### å¹¶å‘æ‰§è¡Œæœºåˆ¶

- **ç›‘ç£è€…**: æ”¯æŒå¤šä¸ªç ”ç©¶ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œ
- **å¹¶å‘é™åˆ¶**: é€šè¿‡ `max_concurrent_research_units` é…ç½®
- **ç»“æœèšåˆ**: æ‰€æœ‰ç ”ç©¶ç»“æœæ±‡æ€»åè¿”å›ç›‘ç£è€…

### é”™è¯¯å¤„ç†æœºåˆ¶

- **Tokené™åˆ¶**: è‡ªåŠ¨æ£€æµ‹ã€æˆªæ–­é‡è¯•ã€æ¸è¿›å¼å‡å°‘
- **å·¥å…·å¤±è´¥**: å®‰å…¨åŒ…è£…ã€é”™è¯¯æ¶ˆæ¯è®°å½•
- **é‡è¯•é€»è¾‘**: ç»“æ„åŒ–è¾“å‡ºå’ŒAPIè°ƒç”¨çš„è‡ªåŠ¨é‡è¯•

### å¾ªç¯é€€å‡ºæ¡ä»¶

- **ç›‘ç£è€…å¾ªç¯**:
    - è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°
    - æ²¡æœ‰å·¥å…·è°ƒç”¨
    - æ˜¾å¼è°ƒç”¨ResearchComplete
- **ç ”ç©¶äººå‘˜å¾ªç¯**:
    - æ—©æœŸé€€å‡º: æ— å·¥å…·è°ƒç”¨
    - æ™šæœŸé€€å‡º: è¾¾åˆ°å·¥å…·è°ƒç”¨é™åˆ¶æˆ–æ˜¾å¼å®Œæˆ
